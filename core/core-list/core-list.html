<link rel="import" href="../core-artc/core-artc.html">
<!--<link rel="import" href="../../bower_components/core-scroll-threshold/core-scroll-threshold.html">-->

<polymer-element name="core-list" attributes="lista">

  <template>
    <style>
      #lister{
            width: 80%;
            margin: 20px auto;
            height: 500px;
        }
        @media(max-width:721px){
          #lister{
            width: 95%;
          }
        }

    </style>
<!--    <core-scroll-threshold id="threshold" scrollTarget="{{$.lister}}" lowerTriggered="{{loadScroll}}"></core-scroll-threshold>-->
<!--    <core-scroll-threshold id="threshold" scrollTarget="{{$lister}}" lowerThreshold="100" on-lower-trigger="{{loadScroll}}" fit></core-scroll-threshold>-->
    
  <div id="lister"><template repeat="{{item in lista}}"></template></div>
<!--  <div hidden?="{{!$.threshold.lowerTriggered}}">Please wait...</div>-->
    
  </template>

  <script>
//    addEventListener('template-bound', function(e) {
//        var scope = e.target;
//        console.log("lanzo envento");
//          scope.loadScroll = function() {
//          setTimeout(function() {
//          this.fire('endofpage');
//          scope.$.threshold.clearLower();
//        }, 1000);
//      };
//    });
    (function () {
      function createPage(item) {
          var section = document.createElement('core-artc');
          section.setAttribute('layout', '');
          section.setAttribute('vertical', '');
          section.setAttribute('htitle', item.title);
          section.setAttribute('content', item.content);
          section.setAttribute('date', item.date);
          section.setAttribute('bgimg', item.bgimg);
          section.setAttribute('owner', item.iduser);
          section.setAttribute('idart', item._id);
          section.setAttribute('coments', item.coments);


          var div = document.createElement('core-card');

          div.setAttribute('css', 'article');
          div.setAttribute('layout', '');
          div.setAttribute('vertical', '');

          div.appendChild(section);

          return div;
      }
      Polymer({
        domReady:function(){
          var that=this;
          addEventListener('resultado-recuperado',function(rescue){
            var list=rescue.detail;
            list.forEach(function (item) {
              that.$.lister.appendChild(createPage(item)); 
            });
          });
        }
//      , loadScroll: function() {
//          console.log("LANZ LA MOVIDA");
//          setTimeout(function() {
//            this.fire('endofpage');
//            scope.$.threshold.clearLower();
//          }, 1000);
//        }
      });
    })();

  </script>

</polymer-element>