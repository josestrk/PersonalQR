<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">

<link rel="import" href="../../bower_components/core-icon/core-icon.html">
<link rel="import" href="../../bower_components/core-input/core-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<!-- <link rel="import" href="../../lib/paper-input-decorator/paper-input-decorator.html"> -->

<polymer-element name="form-field" attributes="label,type,bound,regexp,icon,errorMsg">
  <template>
    <style>
    :host {
      display: block;
      position: relative;
      padding: 0px;
      width: 100%;
      font-weight: 300;
    }

    core-card {
      width: auto;
      height: 55px;
      margin: auto;
      opacity: 1;
      background-color: white;
    }

    #icon {
      width: 25px;
      height: 25px;
      margin: 10px;
      color: black;
    }
    #icon.green {
      color: #22aa00;
    }
    #icon.red {
      color: #cc0022;
    }

    #field {
      width: 80%;
      height: 45px;
      padding: 0px;
    }
    </style>

    <core-card id="form-field-container"
      horizontal layout wrap center-justified>
      <core-icon
        id="icon"
        icon="{{icon}}"
        center-justified horizontal layout wrap center>
      </core-icon>
      <paper-input-decorator
        id="field"
        label="{{label}}" floatingLabel
        error="{{errorMsg}}"
        willvalidate>
          <input
            id="input"
            is="core-input"
            type="{{type}}"
            pattern="{{regexp}}"
            data-tooltip="Hello world"
            required>
      </paper-input-decorator>
    </core-card>

    <content></content>
	</template>

  <!--
  Importing Darktooltip http://rubentd.com/darktooltip/

  <link rel="stylesheet" href="../../lib/darktooltip/css/darktooltip.css">
  <script src="../../bower_components/jquery/dist/jquery.js"></script>
  <script src="../../lib/darktooltip/js/jquery.darktooltip.js"></script>
  -->

  <!--
  Importing Darktooltip http://rubentd.com/darktooltip/

  <script>
  $(document).ready(function(){

    //Basic
    //$('#example').darkTooltip();

    //With some options
    $('#field').darkTooltip({
      animation:'flipIn',
      gravity:'west',
      confirm:true,
      theme:'light'
    });
  });
  </script>
  -->

	<script>
	(function() {
		var values = {};

		Polymer('form-field', {
			ready: function() {
				this.values = values;
				for (var i = 0; i < this.attributes.length; i++) {
				  var attr = this.attributes[i];
				  values[attr.nodeName] = attr.value;
				}

        /*
        Importing Darktooltip http://rubentd.com/darktooltip/

        $(this.$.field).darkTooltip({
          animation:'flipIn',
          gravity:'west',
          confirm:true,
          theme:'light'
        });*/

				this.addEventListener('blur', this.check);
				this.addEventListener('keydown', this.keydown);
			},
			check: function(event, detail, sender) {
        //console.log(this.$.input);
        //console.log(this.$.input.validity);
        //console.log(this.$.input.value);
        //console.log(this.$.input.pattern);
        //console.log(this.$.field.error);

        if (this.$.input.pattern) {
          if (!this.$.input.validity.valid) {
            this.$.icon.className = 'red';
            //this.$.field.isInvalid = true;
          } else {
            this.$.icon.className = 'green';
            //this.$.field.isInvalid = false;
          }
        }
			},
			keydown: function(event, detail, sender) {
				if(event.keyCode === 13) {
					this.check();
				}
			}
		});
	})();
	</script>
</polymer-element>
