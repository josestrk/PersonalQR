<link rel="import" href="../core/core-ajax-handler.html">
<link rel="import" href="../core/core-list/core-list.html">

<polymer-element name="myp-page" attributes="userid">
  <template>
    <core-ajax-handler id="ajaxhandler"></core-ajax-handler>
    
    <main-menu imenu="My profile" progress="{{$.progress}}" on-endofpage="{{debug}}">
      <div class="title">My profile</div>
      <paper-progress id="progress"></paper-progress>
      <core-list id="list" lista="{{lista}}"></core-list>
      <div id="list">
        <template repeat="{{item in lista}}"></template>
      </div>
    </main-menu>
    
  </template>

  <script>
    (function () {
        Polymer({
          ready: function(){
            var _id=document.URL.split('/').reverse()[0].split('=').reverse()[0];
            var that=this;
            var ajaxhandler = this.$.ajaxhandler;
            var sk= this.skip;
            ajaxhandler.getArticles(_id,function (result){
              if(result){
                that.lista=result.reverse();
              }
            });
          },
          debug: function(){
            var that=this;
            var ajaxhandler = this.$.ajaxhandler;
            var sk= this.skip;
            if(this.status!=='fin'){
              //getArticles()
              ajaxhandler.getAllArticles(sk,function (result, status){
                if(status==='fin'){
                  that.status='fin';
                }
                if(result){
                  that.lista=result;
                }
              });
            }
            this.skip++;
          },
          skip: 0,
          status : ''
        });
    })();
  </script>

</polymer-element>
