<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../core/main-menu/main-menu.html">
<link rel="import" href="../core/id-card/id-card.html">
<link rel="import" href="../core/core-ajax-handler.html">

<polymer-element name="person-card" attributes="userid">
  <template>
    <style>
        .card{
            background: #666;
            color: white;
            margin: auto;
            padding: 10px;
            height: 300px;
            box-shadow: rgba(0, 0, 0, 0.0980392) 0px 2px 4px, rgba(0, 0, 0, 0.0980392) 0px 0px 3px;
        }
        id-card{
            width: 100%;
        }
        .rrss{
        
        }
    </style>
    <core-ajax-handler id="ajaxhandler"></core-ajax-handler>
      
    <main-menu imenu="" iduser="{{userid}}">
        <div class="title" id="name"></div>    
        <div class="container">
            <core-card  class="card" layout vertical center center-justified>
                <id-card layout vertical center center-justified>
                    <img class="img" id='photo' src="{{ this.photoUrl }}"/>
                    <user-name id="name"></user-name>
                    <user-account id="email"></user-account>
                    <span id="followers"> </span><span id="following"> </span><span id="numpost"></span>
                </id-card>
            </core-card>
            <core-card class="rrss"></core-card>
        </div>
      
    </main-menu>
  </template>
  <script>
    (function () {
        var id="54cfbbdbb9ee45e4225f0781";
        Polymer({
            ready: function(){
                this.rellenarProfile();
//              var that=this;
//              var ajaxhandler = this.$.ajaxhandler;
//              ajaxhandler.getArticles(document.URL.split('/').reverse()[0].split('=').reverse()[0],function (result){
//                if(result){
//                  that.lista=result.reverse();
//                  var listPost = that.$.list;
//                  that.lista.forEach(function (item) {
//                     listPost.appendChild(createPage(item));
//                  });
//                }
//              });
            },
            rellenarProfile : function (){
                doAjax({
                    type: 'GET',
                    url: 'routes_user/user/:'+id,
                },function( result ) {
                    this.$.photo.src = result.picture ? result.picture : "../img/avatar.svg" ;
                    this.$.name.innerHTML = result.name ? result.name : "Anonimous" ;
                    this.$.email.innerHTML = result.email ? result.email : "" ;
                    this.$.followers.innerHTML = (result.followers) ? result.followers : "0" ;
                    this.$.following.innerHTML = result.following ? result.following : "0" ;
                    this.$.numpost.innerHTML = result.post ? result.post : "0" ;
                }.bind(this),
                       function(xhr, err, desc){
                    var errorToast = document.querySelector('#errorToast');
                    errorToast.text = xhr.responseText.split(':')[1];
                    errorToast.show();
                });
            },
            articlesProfile:function(){
                document.querySelector('app-router').go('/wall/'+id);
            },
            socialProfile: function(){
                
            }
        });
    })();
  </script>
</polymer-element>
