<link rel="import" href="../core/core-ajax-handler.html">
<link rel="import" href="../core/core-list/core-list.html">
<link rel="import" href="not-found.html">

<polymer-element name="wall-page">
  <template>
    <core-ajax-handler id="ajaxhandler"></core-ajax-handler>
    
    <main-menu imenu="Wall" id="wall" logged="{{login.logged}}" progress="{{$.progress}}" on-endofpage="{{debug}}">
      <div class="title">Wall</div>
      <paper-progress id="progress"></paper-progress>
<!--      <core-list id="list" fit></core-list>-->
      <not-found></not-found>
    </main-menu>
    
  </template>

  <script>
    (function () {
      Polymer({
        domReady: function(){
            var that=this;
            var ajaxhandler = this.$.ajaxhandler;
            var sk= this.skip;
            
            ajaxhandler.getAllArticles(sk,function (result){
              if(result){
                that.fire('resultado-recuperado',result);
              }
            });
            this.skip++;
         },
         debug: function(){
            var that=this;
            var ajaxhandler = this.$.ajaxhandler;
            var sk= this.skip;
            if(this.status!=='fin'){
              ajaxhandler.getAllArticles(sk,function (result, status){
                if(status==='fin'){
                  that.status='fin';
                }
                if(result){
                  that.lista.push(result[0]);
                }
              });
            }
            this.skip++;
         }
      });
      }());
  </script>

</polymer-element>
